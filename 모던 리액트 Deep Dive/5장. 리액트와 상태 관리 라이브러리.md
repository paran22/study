## 5장. 리액트와 상태 관리 라이브러리

### 5.1 상태 관리는 왜 필요한가?

- 상태는 어떤 의미를 지닌 값이며, 애플리케이션의 시나리오에 따라 지속적으로 변경될 수 있는 값을 의미한다.
- ui, url, form, 서버에서 가져온 값 등이 있다.

> Flux 패턴
>
> - 양방향이 아닌 단방향으로 데이터 흐름을 변경하는 것을 제안한다.
> - action: 어떤 작업을 처리할 액션과 그 액션 발생 시 함께 포함시킬 데이터를 의미한다.
> - dispatcher: 액션이 정의한 타입과 데이터를 모두 스토어에 보낸다.
> - store: 실제 상태에 따른 값과 액션의 타입에 따라 어떻게 변경할지 정의한다.
> - view: 스토어에서 만들어진 데이터로 화면을 렌더링하는 역할을 하고, 사용자의 입력이나 행위에 따라 상태를 업데이트하기 위해 액션을 호출한다.
> - 리엑트는 단방향 데이터 바인딩을 기반으로 하기 때문에 Flux 패턴과 잘 맞는다.

> Redux
>
> - flux 구조에 Elm 아키텍처의 영향을 받았다.
> - 하나의 상태 객체를 스토어에 저장해두고, 이 객체를 업데이트하는 작업을 디스패치해 업데이트를 수행한다.
> - reducer 함수를 실행해 상태에 대해 완전히 새로운 복사본을 반환한 다음, 애플리케이션에 새롭게 만들어진 상태를 전파한다.

> Context Api
>
> - 전역 상태를 하위 컴포넌트에 주입할 수 있다.
> - 상태 관리가 아닌 주입을 도와주는 기능이며, 렌더링을 막아주는 기능 또한 존재하지 않으니 사용할 때 주의가 필요하다.

- SWR, React Query를 사용하면 애플리케이션의 많은 부분에서 상태를 관리하는 코드가 사라진다.
- Recoil, Zustand, Jotai, Valtio 등 최근에 주목받는 많은 상태관리 라이브러리는 훅을 활용해 작은 크기의 상태를 효율적으로 관리한다. 개발자가 원하는 만큼의 상태를 지역적으로 관리하는 것이 가능해졌다.

### 5.2 리액트 훅으로 시작하는 상태관리

- useState를 기반으로 한 지역 상태는 해당 컴포넌트 내에서만 유효하다.
- 전역 상태 관리를 위해서는 다음과 같은 조건이 필요하다.
  - 컴포넌트 외부 어딘가에 상태를 두고 여러 컴포넌트가 같이 쓸 수 있어야 한다.
  - 이 외부에 있는 상태를 사용하는 컴포넌트는 상태의 변화를 알아챌 수 있어야 하고, 상태가 변경될 때마다 리렌더링이 일어나야 한다. 상태 감지는 이 상태를 참조하는 모든 컴포넌트에서 동일하게 작동해야 한다.
  - 상태가 객체인 경우에는 그 객체에서 내가 감지하지 않는 값이 변한다면 리렌더링이 일어나서는 안된다.
- recoil과 jotai는 context와 provider, 훅을 기반으로 가능한 작은 상태를 효율적으로 관리한다.
- zustand는 스토어가 가지는 클로저를 기반으로 생성되며, 스토어의 상태가 변경되면 이 상태를 구독하고 있는 컴포넌트에 전파에 리렌더링을 알린다. 순수 자바스크립트 환경에서도 사용할 수 있다.
